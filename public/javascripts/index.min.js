window.onload=function(){initfunc();document.getElementById("loginbtn").onclick=loginfunc;document.getElementById("registbtn").onclick=registfunc;document.getElementById("goweh51").onclick=goweh5func;document.getElementById("goweh52").onclick=goweh5func};function initfunc(){$.ajax({url:"/",dataType:"JSON",type:"POST",data:{todo:"init"},success:function(e){if(e.code==200){var t=document.getElementById("reglog");t.innerHTML='<li id="logoutbtn"><a href="javascript:;">退出账号：'+e.username+"</a></li>";document.getElementById("logoutbtn").onclick=logoutfunc}},error:function(e,t,n){console.log("XMLHttpRequest.readyState"+e.readyState);console.log("XMLHttpRequest.status"+e.status);console.log("XMLHttpRequest.responseText"+e.responseText)}})}function goweh5func(){$.ajax({url:"/",dataType:"JSON",type:"POST",data:{todo:"gomyh5"},success:function(e){if(e.code==200){window.location.href="/myh5?user="+e.userid}else if(e.code==404){alert("请先登录")}},error:function(e,t,n){console.log("XMLHttpRequest.readyState"+e.readyState);console.log("XMLHttpRequest.status"+e.status);console.log("XMLHttpRequest.responseText"+e.responseText)}})}function loginfunc(){var e=document.documentElement.scrollHeight;var t=document.documentElement.scrollWidth;var n=document.documentElement.clientHeight;var o=document.documentElement.clientWidth;var l=document.createElement("div");l.id="mask";l.style.height=e+"px";l.style.width=t+"px";document.body.appendChild(l);var c=document.createElement("div");c.id="login";c.innerHTML='<div class="logincon"><div id="close"></div><div class="regloghead">Login Panel</div>'+'<input class="username" type="text" placeholder="username">'+'<input class="password" type="password" placeholder="password"><p class="warnning">&nbsp;</p>'+'<div id="flogin">Login</div></div>';document.body.appendChild(c);var i=c.offsetHeight;var d=c.offsetWidth;c.style.left=(o-d)/2+"px";c.style.top=(n-i)/2+"px";var a=document.getElementById("close");l.onclick=a.onclick=function(){document.body.removeChild(l);document.body.removeChild(c)};var s=document.getElementById("login").getElementsByTagName("input");var r=document.getElementById("flogin");var u=document.getElementById("login").getElementsByTagName("p")[0];r.onclick=function(){var e=s[0].value;var t=s[1].value;$.ajax({type:"POST",dataType:"JSON",url:"/",data:{todo:"login",username:e,password:t},success:function(e){if(e.code==200){u.innerHTML=e.info;u.style.color="green";setTimeout(function(){document.body.removeChild(l);document.body.removeChild(c)},1500);var t=document.getElementById("reglog");t.innerHTML='<li id="logoutbtn"><a href="javascript:;">退出账号：'+e.username+"</a></li>";document.getElementById("logoutbtn").onclick=logoutfunc}else{u.innerHTML=e.info;u.style.color="#cc0001"}},error:function(e,t,n){u.innerHTML="发生错误，请重试";u.style.color="#cc0001"}})}}function registfunc(){var e=document.documentElement.scrollHeight;var t=document.documentElement.scrollWidth;var n=document.documentElement.clientHeight;var o=document.documentElement.clientWidth;var l=document.createElement("div");l.id="mask";l.style.height=e+"px";l.style.width=t+"px";document.body.appendChild(l);var c=document.createElement("div");c.id="login";c.innerHTML='<div class="logincon"><div id="close"></div><div class="regloghead">Regist Panel</div>'+'<input class="username" type="text" placeholder="username">'+'<input class="password" type="password" placeholder="password"><p class="warnning">&nbsp;</p>'+'<div id="flogin">Regist</div></div>';document.body.appendChild(c);var i=c.offsetHeight;var d=c.offsetWidth;c.style.left=(o-d)/2+"px";c.style.top=(n-i)/2+"px";var a=document.getElementById("close");l.onclick=a.onclick=function(){document.body.removeChild(l);document.body.removeChild(c)};var s=document.getElementById("login").getElementsByTagName("input");var r=document.getElementById("flogin");var u=document.getElementById("login").getElementsByTagName("p")[0];r.onclick=function(){var e=s[0].value;var t=s[1].value;$.ajax({type:"POST",dataType:"JSON",url:"/",data:{todo:"regist",username:e,password:t},success:function(e){if(e.code==200){u.innerHTML=e.info;u.style.color="green";setTimeout(function(){document.body.removeChild(l);document.body.removeChild(c);loginfunc()},1500)}else{u.innerHTML=e.info;u.style.color="#cc0001"}},error:function(e,t,n){u.innerHTML="发生错误，请重试";u.style.color="#cc0001"}})}}function logoutfunc(){$.ajax({url:"/",dataType:"JSON",data:{todo:"logout"},type:"POST",success:function(e){if(e.code==200){var t=document.getElementById("reglog");t.innerHTML='<li id="loginbtn"><a href="javascript:;">登录</a></li><li id="registbtn"><a href="javascript:;">注册</a></li>';document.getElementById("loginbtn").onclick=loginfunc;document.getElementById("registbtn").onclick=registfunc}},error:function(e,t,n){console.log("XMLHttpRequest.readyState"+e.readyState);console.log("XMLHttpRequest.status"+e.status);console.log("XMLHttpRequest.responseText"+e.responseText)}})}